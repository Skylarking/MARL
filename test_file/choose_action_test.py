from controller.share_params import RTWMAC
import numpy as np
from common.arguments import get_common_args, get_coma_args, get_RTW_args, get_mixer_args, get_centralv_args, get_reinforce_args, get_commnet_args, get_g2anet_args
from smac.env import StarCraft2Env


obs = [np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.13205296,
        0.        ,  0.13205296,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.18675107,  0.13205296,  0.13205296,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.25094765, -0.16666667,  0.18760851,  1.        ,  1.        ,
        0.        ,  1.        ,  1.        ,  0.13489823, -0.11111111,
        0.0764974 ,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.24942972, -0.05555556,  0.24316406,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.35427517,
        0.        ,  0.35427517,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.24942972,  0.05555556,  0.24316406,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  1.        ,  0.        ], dtype=np.float32), np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.13205296,
        0.        , -0.13205296,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.13205296,  0.13205296,  0.        ,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.1756821 , -0.16666667,  0.05555556,  1.        ,  1.        ,
        0.        ,  1.        ,  1.        ,  0.124226  , -0.11111111,
       -0.05555556,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.124226  , -0.05555556,  0.11111111,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.22222222,
        0.        ,  0.22222222,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.124226  ,  0.05555556,  0.11111111,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  1.        ,  0.        ], dtype=np.float32), np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.18675107,
       -0.13205296, -0.13205296,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.13205296, -0.13205296,  0.        ,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.30384177, -0.2987196 ,  0.05555556,  1.        ,  1.        ,
        0.        ,  1.        ,  1.        ,  0.24942972, -0.24316406,
       -0.05555556,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.21804273, -0.18760851,  0.11111111,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.258497  ,
       -0.13205296,  0.22222222,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.13489823, -0.0764974 ,  0.11111111,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  1.        ,  0.        ], dtype=np.float32), np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.25094765,
        0.16666667, -0.18760851,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.1756821 ,  0.16666667, -0.05555556,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.30384177,  0.2987196 , -0.05555556,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ,  0.124226  ,  0.05555556,
       -0.11111111,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.124226  ,  0.11111111,  0.05555556,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.23570226,
        0.16666667,  0.16666667,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.22906142,  0.22222222,  0.05555556,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ], dtype=np.float32), np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.13489823,
        0.11111111, -0.0764974 ,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.124226  ,  0.11111111,  0.05555556,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.24942972,  0.24316406,  0.05555556,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ,  0.124226  , -0.05555556,
        0.11111111,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.1756821 ,  0.05555556,  0.16666667,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.29917583,
        0.11111111,  0.2777778 ,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.23570226,  0.16666667,  0.16666667,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ], dtype=np.float32), np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.24942972,
        0.05555556, -0.24316406,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.124226  ,  0.05555556, -0.11111111,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.21804273,  0.18760851, -0.11111111,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ,  0.124226  , -0.11111111,
       -0.05555556,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.1756821 , -0.05555556, -0.16666667,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.124226  ,
        0.05555556,  0.11111111,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.11111111,  0.11111111,  0.        ,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ], dtype=np.float32), np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.35427517,
        0.        , -0.35427517,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.22222222,  0.        , -0.22222222,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.258497  ,  0.13205296, -0.22222222,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ,  0.23570226, -0.16666667,
       -0.16666667,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.29917583, -0.11111111, -0.2777778 ,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.124226  ,
       -0.05555556, -0.11111111,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.124226  ,  0.05555556, -0.11111111,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ], dtype=np.float32), np.array([ 1.        ,  1.        ,  1.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.24942972,
       -0.05555556, -0.24316406,  1.        ,  1.        ,  1.        ,
        0.        ,  1.        ,  0.124226  , -0.05555556, -0.11111111,
        1.        ,  1.        ,  1.        ,  0.        ,  1.        ,
        0.13489823,  0.0764974 , -0.11111111,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ,  0.22906142, -0.22222222,
       -0.05555556,  1.        ,  1.        ,  0.        ,  1.        ,
        1.        ,  0.23570226, -0.16666667, -0.16666667,  1.        ,
        1.        ,  0.        ,  1.        ,  1.        ,  0.11111111,
       -0.11111111,  0.        ,  1.        ,  1.        ,  0.        ,
        1.        ,  1.        ,  0.124226  , -0.05555556,  0.11111111,
        1.        ,  1.        ,  0.        ,  1.        ,  1.        ,
        1.        ,  0.        ,  1.        ], dtype=np.float32)]
avail_actions = [[0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0]]


args = get_common_args()
get_mixer_args(args)
get_RTW_args(args)


if args.env == 'smac':
    env = StarCraft2Env(map_name=args.map,
                        step_mul=args.step_mul,
                        difficulty=args.difficulty,
                        game_version=args.game_version,
                        replay_dir=args.replay_dir)
else:
    raise ValueError("env not found")

env_info = env.get_env_info()  # env info for other args
args.n_actions = env_info["n_actions"]
args.n_agents = env_info["n_agents"]
args.state_shape = env_info["state_shape"]
args.obs_shape = env_info["obs_shape"]
args.episode_limit = env_info["episode_limit"]


mac = RTWMAC(args)

last_actions = np.zeros((args.n_agents, args.n_actions))
action = mac.choose_action(np.stack(obs, axis=0), last_actions, np.stack(avail_actions, axis=0), 1, False)